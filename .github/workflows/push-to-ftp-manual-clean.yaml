name:                           ğŸ§ª Manual | Prod | Reset
on:                             [workflow_dispatch]
jobs:
  web-deploy:
    name:                       ğŸ‰ Manual Clean & Deploy
    runs-on:                    ubuntu-latest
    steps:
    - name:                     ğŸšš Get latest code
      uses:                     actions/checkout@v2.3.2

    - name:                     ğŸ±â€ğŸ‘¤ Use Node.js 14.17.1
      uses:                     actions/setup-node@v2-beta
      with:
        node-version:           '14.17.1'

    - name:                     ğŸ’¥ Install & Cache Deps
      uses:                     bahmutov/npm-install@v1.4.5
      with:
        working-directory:      client

    - name:                     ğŸ§¹ Lint Build
      run:                      npm run lint:ts
      working-directory:        client

    - name:                     ğŸ”¨ Build Project
      run:                      INLINE_RUNTIME_CHUNK=false npm run build
      working-directory:        client

    - name:                     ğŸ§ª Test Build
      run:                      npm test
      working-directory:        client

    - name:                     ğŸ“‚ Sync files
      uses:                     SamKirkland/FTP-Deploy-Action@4.0.0
      with:
        server:                 ${{ secrets.ftpserver }}
        username:               ${{ secrets.ftpuser }}
        password:               ${{ secrets.ftppass }}
        local-dir:              ./client/build/
        dangerous-clean-slate:  true