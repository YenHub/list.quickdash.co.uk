name:                  ğŸ§ª Prod | Manual Deploy
on:                    [workflow_dispatch]
jobs:
  web-deploy:
    name:              ğŸ‰ Deploy
    runs-on:           ubuntu-latest
    steps:
    - name:            ğŸ“© Check Out Code
      uses:            actions/checkout@v2.3.2

    - name:            ğŸ”¥ Sync files to the server
      uses:            SamKirkland/FTP-Deploy-Action@4.0.0
      with:
        server:        ${{ secrets.ftpserver }}
        username:      ${{ secrets.ftpuser }}
        password:      ${{ secrets.ftppass }}
        local-dir:     ./static/
        server-dir:    public_html/

    - name:            ğŸ±â€ğŸ‘¤ Prep Node 12 Image
      uses:            actions/setup-node@v2-beta
      with:
        node-version:  '12'

    - name:            ğŸŒ Generate & Add Sitemap
      run:             |
        cd static
        npx sitemap-generator-cli -d 10 -l -g monthly -c 15 https://www.atkin-farm-machinery.co.uk/

    - name:            ğŸ”¥ Re-Sync with SiteMap
      uses:            SamKirkland/FTP-Deploy-Action@4.0.0
      with:
        server:        ${{ secrets.ftpserver }}
        username:      ${{ secrets.ftpuser }}
        password:      ${{ secrets.ftppass }}
        local-dir:     ./static/
        server-dir:    public_html/