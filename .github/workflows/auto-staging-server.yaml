on:
  push:
    branches:
      - feature/share-list
    paths:
      - 'server/**'

name:                       ğŸ§ª Auto | Staging | Server
jobs:
  server-deploy:
    name:                   ğŸ‰ Deploy Server
    runs-on:                ubuntu-latest
    steps:
    - name:                 ğŸšš Get latest code
      uses:                 actions/checkout@v2.3.2

    - name:                 ğŸ±â€ğŸ‘¤ Use Node.js 14.17.1
      uses:                 actions/setup-node@v2-beta
      with:
        node-version:       '14.17.1'

    - name:                 ğŸ’¥ Install & Cache Deps (SERV)
      uses:                 bahmutov/npm-install@v1.4.5
      with:
        working-directory:  server

    - name:                 ğŸ§¹ Lint Build  (SERV)
      run:                  npm run lint:ts
      working-directory:    server

    - name:                 ğŸ”¨ Build Project  (SERV)
      run:                  npm run build:staging
      working-directory:    server

    # - name:               ğŸ“‚ Sync Server
    #   uses:               SamKirkland/FTP-Deploy-Action@4.0.0
    #   with:
    #     password:         ${{ secrets.servr_ftppass_staging }}
    #     server:           ${{ secrets.server_ftpserver_staging }}
    #     username:         ${{ secrets.server_ftpuser_staging }}
    #     local-dir:        ./server/dist/